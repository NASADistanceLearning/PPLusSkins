var currentSlide="";var currentLargeSlide="";function lg_slide(){Lvl_openWin("lg_slide.htm","_lgslide","960","720","0","0","0","width=960,height=720");return document.MM_returnValue}function Lvl_openWin(j,b,k,m,a,i,e,g){var d=((screen.width-k)/2);if(e==1){a=d;i=(screen.height-m)/2}if(e==2){a=d}g+=",top="+i+",left="+a;lgwin=window.open(j,b,g);lgwin.focus()}var lgwin=false;function updLargeSld(a){try{if(lgwin){lgwin.document.lg.src=a;lgwin.document.org.src=a}}catch(c){var b=c}}var stretch2fit="true";var ie,ns,mz,debug,msver,os;var ie=self.document.all;var ns=eval("self.document.layers");var mz=self.document.getElementById;var os=1;var debug=eval(getvar("debug","false"));var os,browser,version,data;function getvar(el,def){var urls=new String(eval("self.location"));var re=new RegExp("\\?[\\w\\W]*"+el+"=([^\\&\\?#]*)","i");var arr=re.exec(urls);if(arr&&arr.length>1){return arr[1]}else{return def}}function echo(a){document.open();document.write(a);document.close()}function html_friendly(a){a=new String(a);a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");return"<code><pre>"+a+"</pre></code>"}function video6ms(d,b,c,a){var f=new String();var e;if(b=="mini"){e=56}else{if(b=="full"){e=72}else{e=0}}f+='<object id="MediaPlayer" width="'+c+'" height="'+(a+e)+'" classid="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95" codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112" standby="Loading Microsoft? Windows? Media Player components... " type="video/x-ms-wmv">\r\n';f+='\t<param name="FileName" value="'+d+'" />\r\n';f+='\t<param name="AutoStart" value="1" />\r\n';f+='\t<param name="AnimationatStart" value="1" />\r\n';f+='\t<param name="InvokeURLs" value="0" />\r\n';switch(b){case"none":f+='\t<param name="ShowControls" value="0" />\r\n';f+='\t<param name="ShowTracker" value="0" />\r\n';f+='\t<param name="EnableTracker" value="0" />\r\n';f+='\t<param name="ShowPositionControls" value="0" />\r\n';f+='\t<param name="EnablePositionControls" value="0" />\r\n';f+='\t<param name="ShowStatusBar" value="0" />\r\n';break;case"mini":f+='\t<param name="ShowControls" value="1" />\r\n';f+='\t<param name="ShowTracker" value="0" />\r\n';f+='\t<param name="EnableTracker" value="0" />\r\n';f+='\t<param name="ShowPositionControls" value="0" />\r\n';f+='\t<param name="EnablePositionControls" value="1" />\r\n';f+='\t<param name="ShowStatusBar" value="1" />\r\n';break;case"full":f+='\t<param name="ShowControls" value="1" />\r\n';f+='\t<param name="ShowTracker" value="1" />\r\n';f+='\t<param name="EnableTracker" value="1" />\r\n';f+='\t<param name="ShowPositionControls" value="1" />\r\n';f+='\t<param name="EnablePositionControls" value="1" />\r\n';f+='\t<param name="ShowStatusBar" value="1" />\r\n';break}f+='\t<embed type="application/x-mplayer2" pluginspage="http://www.microsoft.com/Windows/Downloads/Contents/Products/MediaPlayer/" \r\n';f+='\tInvokeURLs="0" \r\n';switch(b){case"none":f+='\t ShowControls="0" \r\n';f+='\t ShowTracker="0" \r\n';f+='\t EnableTracker="0" \r\n';f+='\t ShowPositionControls="0" \r\n';f+='\t EnablePositionControls="0" \r\n';f+='\t ShowStatusBar="0" \r\n';break;case"mini":f+='\t ShowControls="1" \r\n';f+='\t ShowTracker="0" \r\n';f+='\t EnableTracker="0" \r\n';f+='\t ShowPositionControls="0" \r\n';f+='\t EnablePositionControls="1" \r\n';f+='\t ShowStatusBar="1" \r\n';break;case"full":f+='\t ShowControls="1" \r\n';f+='\t ShowTracker="1" \r\n';f+='\t EnableTracker="1" \r\n';f+='\t ShowPositionControls="1" \r\n';f+='\t EnablePositionControls="1" \r\n';f+='\t ShowStatusBar="1" \r\n';break}f+='\t src="'+d+'" name="MediaPlayer" \r\n';f+='\t AutoStart="1" \r\n';f+='\t AnimationatStart="1" \r\n';f+='\t width="'+c+'" height="'+(a+e)+'"></embed></object>\r\n';if(ns){f+='\t<APPLET MAYSCRIPT code="NPDS.npDSEvtObsProxy.Class" width="1" height="5" name="appObs"></APPLET>\r\n'}else{f+='<script language="JScript" for="MediaPlayer" event="ScriptCommand(scType, Param)">ms9sync(scType, Param);</script>\r\n';f+='<script id="PlayStateChange" language="JScript" for="MediaPlayer" event="PlayStateChange(NewState)">playStateChange(NewState);</script>'}if(debug){echo(html_friendly(f))}else{echo(f)}}function notsupported(){var a="Internet Explorer 4+";if(ns){a="Netscape 4.x"}else{if(mz){a="Netscape 6+ (or Mozilla 1+)"}}var b="<strong>"+a+" and Windows Media Player "+msver+" is NOT currently supported.</strong>\r\n<br>\r\n";echo("<div class='error'>"+b+"</div>")}function video9ms(e,f,b,g,a){var c=/^[\s]*$/i;var h=new String();var d=64;if(f=="none"){d=0}if(ie||(mz&&window.GeckoActiveXObject)){h+='<object id="MediaPlayer" width="'+b+'" height="'+(g+d)+'" classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6">\r\n';h+='\t<param name="URL" value="'+e+'" />\r\n'}else{h+='<applet name="MediaPlayer" code="WMPNS.WMP" width="'+b+'" height="'+(g+d)+'" mayscript="true">\r\n';h+='\t<param name="URL" value="'+e+'" />\r\n'}h+='\t<param name="autoStart" value="true" />\r\n';h+='\t<param name="enabled" value="true" />\r\n';h+='\t<param name="invokeURLs" value="false" />\r\n';h+='\t<param name="uiMode" value="'+f+'" />\r\n';h+='\t<param name="DefaultFrame" value="region1" />\r\n';h+='\t<param name="stretchToFit" value="'+stretch2fit+'" />\r\n';if(arguments.length>=5&&!c.test(a)){h+='\t<param name="SAMIFileName" value="'+a+'" />\r\n';h+='\t<param name="captioningID" value="mscc"/>\r\n'}if(ie){h+="</object>";h+='<script language="JavaScript" for="MediaPlayer" event="PositionChange()">updateRegions(Math.floor(document.MediaPlayer.Controls.currentPosition));</script>';h+='<script language="JavaScript" for="MediaPlayer" event="ScriptCommand(scType, Param)">ms9sync(scType, Param);</script>';h+='<script language="JavaScript" for="MediaPlayer" event="OpenStateChange(NewState)">wait_load(NewState);</script>';h+='<script id="PlayStateChange" language="JavaScript" for="MediaPlayer" event="PlayStateChange(NewState)">playStateChange(NewState);</script>'}else{h+="</applet>"}if(debug){echo(html_friendly(h))}else{echo(h)}}function notsupported(){var a="Internet Explorer 4+";if(ns){a="Netscape 4.x"}else{if(mz){a="Netscape 6+ (or Mozilla 1+)"}}var b="<strong>"+a+" and Windows Media Player "+msver+" is NOT currently supported.</strong>\r\n<br>\r\n";echo("<div class='error'>"+b+"</div>")}function Initialize(){if(hasP25()){document.getElementById("MediaPlayer").settings.invokeURLs=false}}function videoms(d,b,c,a,e){b=new String(b);b=b.toLowerCase(b);if(msver>=7){video9ms(d,b,c,a,e)}else{video6ms(d,b,c,a,e)}}function strsafe(b){var d=new String(b);var a=new RegExp("'","g");var c=new RegExp("\\\\","g");if(a.test(d)){d=d.replace(a,"\\'")}if(c.test(d)){d=d.replace(c,"\\\\")}return(d)}function underscore(a){var c=new String(a);var b=new RegExp("[ \\s\\t\\r\\n]+","g");if(b.test(c)){c=c.replace(b,"_")}return(c)}function ms9sync(b,a){handleSync(b,a)}function handleSync(type,url){if(!type||!url){return}var u=url.toLowerCase();if(u.indexOf("attp")==0){eval(url.substring(7,url.lastIndexOf("&&")));return}var t=type.toLowerCase();if(t!="url"){return}var iframe=null;var region="";var delimiter="&&";var index=u.indexOf(delimiter);if(index>0){u=url.slice(0,index);region=url.substr(index+delimiter.length);if(isNullOrBlank(region)){region="__pop_up__"}else{iframe=parent.document.getElementById(region)}region=region.replace(" ","_")}var isImage=isImageUrl(u);if(isUrlLocal(u)){t="slide"}if(region=="region1"){var result=updateUrl(t,region,u,isImage);isImage=result.isImage;u=result.url}var handle;if(!iframe){handle=window.open(u,region)}else{var synced=false;if(isImage==true&&isUrlLocal(iframe.src)){try{if(t=="slide"){if(parent.frames[region].swapImage){parent.frames[region].swapImage(u);synced=true}}else{if(parent.frames[region].__imgViewer&&parent.frames[region].swapImage){parent.frames[region].swapImage(u);synced=true}}}catch(ex){}}if(!synced){iframe.src=u}}handleUiAfterSync(t,region,u,isImage);return handle}function updateUrl(c,d,a,b){if(b){if(c=="slide"){currentLargeSlide=a.replace("_1.","_lg.");a="seek.htm?img={0}".format(a)}else{currentLargeSlide=a;a="viewer.htm?img={0}".format(a)}}else{currentLargeSlide=getUnavailableSlideImage()}return{isImage:b,url:a}}function handleUiAfterSync(c,d,a,b){if(d=="region1"){updLargeSld(currentLargeSlide,false)}else{if(d=="Interactive"){window.top.changeMenu(6)}}}function RemoveURL(b){if(b.length>3){var a=b.lastIndexOf("/");if(a==-1){a=b.lastIndexOf("\\")}if((a!=-1)&&(a<(b.length-1))){return b.substring(a+1)}}return b}function OnScriptCommand(b,a){ms9sync(b,a)}var _defaultStart=getvar_parent("time");function wait_load(a){if(a==13){if(_defaultStart){seek(_defaultStart);_defaultStart=""}}}function detectbrowser(){var a=navigator.userAgent.toLowerCase();if(detectagent("msie",a)){browser="ie"}else{if(detectagent("firefox",a)){browser="firefox"}else{if(detectagent("netscape",a)){browser="netscape"}else{if(detectagent("safari",a)){browser="safari"}else{if(detectagent("opera",a)){browser="opera"}else{if(detectagent("konqueror",a)){browser="konqueror";os="linux"}else{if(detectagent("omniweb",a)){browser="omniweb"}else{if(detectagent("webtv",a)){browser="webtv"}else{if(detectagent("icab",a)){browser="icab"}else{if(!detectagent("compatible",a)){browser="mozilla";version=a.charAt(8)}else{browser="unknown"}}}}}}}}}}if(!version){version=a.charAt(stringposition+data.length)}if(detectagent("linux",a)){os="linux"}else{if(detectagent("x11",a)){os="unix"}else{if(detectagent("mac",a)){os="mac"}else{if(detectagent("win",a)){os="win"}else{os="unknown"}}}}}function detectagent(a,b){stringposition=b.indexOf(a)+1;data=a;return stringposition}function detectms(){if(ie){echo('<OBJECT classid="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95" id="WMP64" width="1" height="1" VIEWASTEXT="true"></OBJECT>\r\n');echo('<OBJECT classid="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" id="WMP7"  width="1" height="1" VIEWASTEXT="true"></OBJECT>\r\n')}navigator.plugins.refresh();var platform=new String(navigator.platform);var winre=/^win32/i;var macre=/mac/i;if(winre.test(platform)){os=1}else{if(macre.test(platform)){os=2}else{os=3}}detectbrowser();if(ie&&os!=3){if(WMP7){wmp=true;var tmp=new String(WMP7.versionInfo);var vre=/^[\d]+.[\d]/i;if(vre.test(tmp)){msver=eval(vre.exec(tmp)[0])}else{msver=6.4}}else{if(WMP64){wmp=true;msver=6.4}else{msver=0;wmp=false}}}else{if(ns||mz||(ie&&os==2)){var wre=/^Windows[\w]{0,3} Media Player/i;var dre=/^Microsoft[^d]{1,7}drm$/i;var wmp=false;var drmcount=0;var parr=[];for(var i=0;i<navigator.plugins.length;i++){parr[i]=new String(navigator.plugins[i].name);if(!wmp&&wre.test(new String(parr[i]))){wmp=true}if(drmcount<2&&dre.test(new String(parr[i]))){drmcount++}}if(wmp){switch(drmcount){case 2:msver=9;break;case 1:msver=7;break;default:msver=6;break}}else{msver=0}}else{wmp=false;msver=0}}}function time2s(c){var d=/[0]*([1-9])/g;c=new String(c);if(d.test(c)){c=c.replace(d,"$1")}var b=c.split(":");var a=parseInt(b[b.length-1]);a+=parseInt(b[b.length-2])*60;a+=parseInt(b[b.length-3])*60*60;return a}function seek(b){var a=self.document.getElementById("MediaPlayer");if(a){if(b==""){return}if(hasP25()){updateRegions(b)}if((ie&&msver<7)||(!ie&&msver<9)){if(a){if(ie||hasP25()){a.CurrentPosition=time2s(b)}else{a.SetCurrentPosition(time2s(b))}a.Play()}}else{if(a){if(ie||hasP25()){a.controls.currentPosition=time2s(b);a.controls.play()}else{a.controls.setCurrentPosition(time2s(b));a.getControls().play()}}}}else{setMediaPosition(time2s(b))}}function PlayClick(){var a;var b=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){if(!ie&&!hasP25()){a=b.GetPlayState()}else{a=b.playState}if(a==0){b.play()}else{if(a==1){b.play()}}}else{if(ie||hasP25()){a=b.playState;if(a==1||a==2||a==10){b.controls.play()}}else{a=b.getPlayState();if(a==1||a==2||a==10){b.getControls().play()}}}}function PauseClick(){var a;var b=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){if(!ie&&!hasP25()){a=b.GetPlayState()}else{a=b.playState}if(a==2){b.pause()}else{if(a==1){b.play()}}}else{if(ie||hasP25()){a=b.playState;if(a==3){b.controls.pause()}else{if(a==2){b.controls.play()}}}else{a=b.getPlayState();if(a==3){b.getControls().pause()}else{if(a==2){b.getControls().play()}}}}}function StopClick(){var a=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){a.stop()}else{if(ie||hasP25()){a.controls.stop()}}}function NextClick(){var a=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){a.next()}else{if(ie||hasP25()){a.controls.next()}}}function updateRegions(b){if(!_events){return}var a=_events.find(b);if(!a){return}ms9sync("URL",a.getText()+"&&"+a.getRegion())}function VolumeUp(){var b=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){if(ie||hasP25()){var a=b.Volume+1000;if(a>0){a=0}b.Volume=a}else{var a=b.GetVolume()+1000;if(a>0){a=0}b.SetVolume(a)}}else{if(ie||hasP25()){var a=b.settings.volume+10;if(a>=100){a=100}b.settings.volume=a}else{var a=b.settings().getVolume()+10;if(a>=100){a=100}b.settings().setVolume(a)}}}function VolumeDown(){var b=document.getElementById("MediaPlayer");if((ie&&msver<7)||(!ie&&msver<9)){if(ie||hasP25()){var a=b.Volume-1000;if(a<0-10000){a=0-10000}b.Volume=a}else{var a=b.GetVolume()-1000;if(a<0-10000){a=0-10000}b.SetVolume(a)}}else{if(ie||hasP25()){var a=b.settings.volume-10;if(a<0){a=-10}b.settings.volume=a}else{var a=b.settings().GetVolume()-10;if(a<0){a=-10}b.settings().SetVolume(a)}}}function full_screen(b){var d=(b!==false);var c=document.getElementById("MediaPlayer");if(c){if(msver>=7){if(ie||hasP25()){if(c.playState==3){c.fullScreen=d}}else{var a=c.getPlayState();if(a==3){c.setfullScreen=d}}}}else{if(window.goFullScreen&&typeof(window.goFullScreen)=="function"){window.goFullScreen()}}}function getvar_parent(b,e){var a="";if(!e){a="i"}var d=new String(window.parent.location);var f=new RegExp("\\?[\\w\\W]*"+b+"=([^\\&\\?#]*)",a);var c=f.exec(d);if(c&&c.length>1){return c[1]}else{return""}}function getMaxMarkerCount(){var b=0;try{b=parent.__maxDisplayedMarkers}catch(a){}return b};